<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-4xl mx-auto px-4">
    <div *ngIf="loading" class="flex justify-center py-8">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <div *ngIf="error" class="text-center py-8">
      <p class="text-red-600">Error loading report. Please try again.</p>
      <button mat-button color="primary" (click)="loadReport(reportId!)">Retry</button>
    </div>

    <mat-card *ngIf="!loading && !error">
      <mat-card-header class="justify-center mb-6">
        <mat-card-title class="text-2xl font-bold">Edit Gemmological Report</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <!-- Image Gallery -->
        <div class="mb-6">
          <swiper-container *ngIf="images.length > 0">
            <swiper-slide *ngFor="let image of images; let i = index" class="relative">
              <img [src]="image" alt="Gem image" class="w-full h-64 object-contain">
              <button
                (click)="removeImage(i)"
                class="absolute top-2 right-2 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-colors"
                mat-icon-button>
                <mat-icon>close</mat-icon>
              </button>
            </swiper-slide>
          </swiper-container>
        </div>

        <form [formGroup]="reportForm" (ngSubmit)="onSubmit()" class="grid grid-cols-2 gap-4">
          <mat-form-field appearance="outline">
            <mat-label>Report Number</mat-label>
            <input matInput formControlName="reportNumber">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Date</mat-label>
            <input matInput formControlName="date" type="date">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Colour</mat-label>
            <input matInput formControlName="colour">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Species</mat-label>
            <input matInput formControlName="species">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Item</mat-label>
            <input matInput formControlName="item">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Variety</mat-label>
            <input matInput formControlName="variety">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Weight</mat-label>
            <input matInput formControlName="weight">
            <span matSuffix>ct</span>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Origin</mat-label>
            <input matInput formControlName="origin">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Shape</mat-label>
            <input matInput formControlName="shape">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Condition</mat-label>
            <input matInput formControlName="condition">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Cut</mat-label>
            <input matInput formControlName="cut">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Measurements</mat-label>
            <input matInput formControlName="measurements">
            <span matSuffix>mm</span>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Transparency</mat-label>
            <input matInput formControlName="transparency">
          </mat-form-field>

          <div class="col-span-2 flex justify-end gap-4">
            <button mat-button [routerLink]="['/reports', reportId]">
              Cancel
            </button>
            <button mat-raised-button color="primary" type="submit" [disabled]="!reportForm.valid || saving">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>